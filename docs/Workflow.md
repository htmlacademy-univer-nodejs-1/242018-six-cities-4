# Как работать над проектом

## Окружение

Для удобства работы над проектом используются инструменты из **Node.js** и **npm**. Все необходимые настройки произведены. Убедитесь, что на рабочем компьютере установлен актуальный LTS релиз Node.js**. Актуальная версия **Node.js** указана в файле `package.json` в поле `node`. Затем, в терминале, перейдите в директорию с проектом и _единожды_ запустите команду:

```bash
npm install
```

Команда запустит процесс установки зависимостей проекта из **npm**.

## Запуск MongoDB

```
docker-compose up -d
```

### Сценарии

В `package.json` предопределено несколько сценариев.

#### Запустить JSON-сервер

```bash
npm run mock-server
```

## Генерация мок-данных и запись их в TSV файл:
```bash
npm run cli -- --generate 10 mocks/test-data.tsv http://localhost:1234/api
```

## Импорт данных из TSV файла:
```bash
npm run cli -- --import mocks/test-data.tsv 127.0.0.1 admin test 27017 six-cities 69420
```

#### Скомпилировать проект

```bash
npm run compile
```

Создаст директорию `dist` и скомпилирует проект.

#### Удалить скомпилированный проект

```bash
npm run clean
```

Удаляет директорию `dist`. Используется перед компиляцией.

#### Собрать проект

```bash
npm run build
```

Выполняет сборку проекта: удаляет ранее скомпилированный проект и компилирует заново.

#### Проверить линтером

```bash
npm run lint
```

Запуск проверки проекта статическим анализатором кода **ESLint**.

Линтер проверяет файлы только внутри директории `src`.

**Обратите внимание**, при запуске данной команды, ошибки выводятся в терминал.

#### Запустить ts-модуль без компиляции

```bash
npm run ts -- <Путь к модулю с ts-кодом>
```

Пакет `ts-node` позволяет выполнить TS-код в Node.js без предварительной компиляции. Используется только на этапе разработки.

#### Запустить проект в режиме разработки

```bash
npm run start:dev
```

Запускает сервер приложения в режиме разработки с автоматической перезагрузкой при изменении файлов.

#### Запустить проект в production режиме

```bash
npm start
```

Выполняет полную сборку проекта и запускает оптимизированную версию приложения для продакшена.

## Структура проекта

### Основные директории

#### `/src` - Исходный код приложения
Содержит весь TypeScript код проекта, включая:
- **CLI модули** - команды для работы с приложением через терминал
- **REST API** - серверная часть приложения 
- **Shared модули** - общие компоненты, типы и утилиты

#### `/mocks` - Тестовые данные
- `testdata.tsv` - данные для импорта в базу
- `mock-server-data.json` - данные для JSON сервера

#### `/markup` - Статические файлы
Готовая HTML верстка, стили и изображения для фронтенда.

#### `/specification` - API документация
OpenAPI спецификация REST API приложения.

### Конфигурационные файлы

#### `package.json`
Основной файл конфигурации Node.js проекта с зависимостями и скриптами.

#### `tsconfig.json`
Настройки компилятора TypeScript.

#### `docker-compose.yml`
Конфигурация для запуска MongoDB в Docker контейнере.

#### `.env.example` - Шаблон переменных окружения

Необходимые переменные для работы приложения:

**Сервер**
- `PORT` - порт для запуска HTTP сервера (по умолчанию 4000)

**База данных MongoDB**
- `DB_HOST` - хост базы данных (например, localhost)
- `DB_PORT` - порт MongoDB (по умолчанию 27017)
- `DB_USER` - имя пользователя для подключения к БД
- `DB_PASSWORD` - пароль пользователя БД
- `DB_NAME` - название базы данных

**Безопасность**
- `SALT` - соль для хеширования паролей
- `JWT_SECRET` - секретный ключ для JWT токенов

**Файловая система**
- `UPLOAD_DIRECTORY` - директория для загружаемых файлов
- `STATIC_DIRECTORY_PATH` - путь к статическим файлам

### Документация

- `Readme.md` - основная информация о проекте
- `Contributing.md` - правила участия в разработке
- `Workflow.md` - данное руководство по работе с проектом